function [Fv,FvT]=ceus_site_lin_Fv(Vs30,T)

% modified from Jon Stewart's 'NGA_E_site_071818.r" 
% linear part only
% Fv part only (correction for 760, not 3000)
% see PEER report Stewart et al. (2017)

Fv_per = [-1,0,0.01,0.02,0.03,0.04,0.05,0.075,0.08,0.1,0.11,0.112,0.113,0.114,0.115,0.116,0.117,0.118,0.119,0.12,0.125,0.13,0.135,0.14,0.15,0.2,0.25,0.3,0.4,0.5,0.75,0.8,1,1.5,2,3,4,5,7.5,10];
Vref = 760.*ones(1,length(Fv_per));
c = [-0.449, -0.29, -0.29, -0.303, -0.315, -0.33075, -0.34375, -0.34825, -0.35775, -0.37175, -0.374100376242173, -0.3745623416695, -0.374794027466193, -0.375026469767833, -0.375259869798249, -0.375494417807859, -0.375730293632696, -0.375967667222571, -0.376206699140283, -0.376447541033625, -0.377683638041695, -0.378983323180588, -0.380357811969696, -0.381815244355314, -0.385, -0.403, -0.41675, -0.42625, -0.45175, -0.4795, -0.51025, -0.523, -0.557, -0.5735, -0.58425, -0.588, -0.579, -0.5575, -0.544, -0.507];
V1 = [331, 319, 319, 319, 319, 319, 319, 319, 318.375, 317.125, 315.267520356978, 314.776032223556, 314.517963908781, 314.252152700497, 313.978936067031, 313.698638236404, 313.411570782511, 313.118033181464, 312.818313339828, 312.51268809639, 310.90495360878, 309.185517735109, 307.37901012838, 305.505874198661, 301.625, 279, 249.875, 224.5, 216.5, 216.875, 226.875, 235, 254.75, 275.5, 296, 311.5, 321.25, 324.25, 325, 325];
V2 = [760,760, 760, 760, 810, 900, 1010, 1380, 1450, 1900, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 1800, 1775, 1500, 1072.91171077024, 944.810285490596, 867.450972340815, 842.719886563071, 822.119527876778, 814.212170473012, 810, 790, 805, 810, 819.939582916671, 821.330456623893, 825, 819.756426598506, 820];
% Vf = [314, 345, 345, 343, 342, 340, 338, 334, 333, 319, 318.412340433872, 318.301242677602, 318.246435573122, 318.192111356895, 318.138261594029, 318.084878068727, 318.031952776762, 317.979477918274, 317.927445890874, 317.875849283033, 317.624150716967, 317.38232526535, 317.149627511412, 316.925393394569, 316.5, 314, 282, 250, 250, 280, 280, 280, 300, 300, 300, 313, 322, 325, 328, 330];

% this is the impedance F760
F760 = [0.3753, 0.185, 0.185, 0.185, 0.224, 0.283, 0.337, 0.475, 0.512, 0.674, 0.729982785604447, 0.74137251532296, 0.74741722477742, 0.753003958344628, 0.757587669891615, 0.760651783288151, 0.761782450402077, 0.761102319298591, 0.758942821962947, 0.755620422115111, 0.732339084465566, 0.716406123665552, 0.668700498015965, 0.66026067369634, 0.586, 0.419, 0.332, 0.27, 0.209, 0.175, 0.127, 0.12, 0.095, 0.083, 0.079, 0.073, 0.066, 0.064, 0.056, 0.053];

%%%%% compute Vs30-scaling Fv
Fv = zeros(1, length(Fv_per));
for ii=1:length(Fv_per)
    if Vs30 <= V1(ii)
      Fv(ii) = c(ii).*log(V1(ii)./Vref(ii));
    elseif Vs30 <= V2(ii)
      Fv(ii) = c(ii).*log(Vs30./Vref(ii));
    elseif Vs30 <= 2000
      Fv(ii) = c(ii).*log(V2(ii)./Vref(ii)) ;
    elseif Vs30 > 2000
        %want to linearly interpolate between value at 2000 m/s1/F760 and 
        F2000 = c(ii).*log(V2(ii)./Vref(ii)) ;
        Fv(ii) = interp1(log([2000 3000]),[F2000 -F760(ii)],log(Vs30));
    end
end
% Fv=Fv+F760;

% interpolate at T
if (isempty(find(abs((Fv_per - T)) < 0.0001)));
    T_low = max(Fv_per(Fv_per<T));
    T_hi  = min(Fv_per(Fv_per>T));
    il=Fv_per==T_low;
    ih=Fv_per==T_hi;

    x = [log(T_low) log(T_hi)];
    Yi = [Fv(il) Fv(ih)];
    FvT = interp1(x,Yi,log(T));
else
    ind = find(abs((Fv_per - T)) < 0.0001); % Identify the Fv_per
    FvT=Fv(ind);
end